---
title: "Lithic artifacts and texture analysis: a low magnification approach"
author: "Guillermo Bustos-Pérez$^{1,2,3}"
output: 
  md_document:
    variant: gfm
  pdf_document: default
  bookdown::html_document2: 
    toc: true
    toc_float: true
    toc_depth: 4
    fig_caption: yes
    number_sections: FALSE
  bookdown::word_document2:
    reference_docx: "References_Styles/word-styles-reference.docx"
    fig_caption: yes
    number_sections: FALSE
    code_folding: "hide"
bibliography: "References_Styles/References.bib"
csl: "References_Styles/journal-of-archaeological-science.csl"
link-citations: true
linkcolor: blue
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

$^1$Universidad Autónoma de Madrid. Departamento de Prehistoria y Arqueología, Campus de Cantoblanco, 28049 Madrid, Spain.   
$^2$Institut Català de Paleoecologia Humana i Evolució Social (IPHES), Zona Educacional 4, Campus Sescelades URV (Edifici W3), 43007 Tarragona, Spain.      
$^3$Àrea de Prehistoria, Universitat Rovira i Virgili (URV), Avinguda de Catalunya 35, 43002 Tarragona, Spain.    

\ 
   
<div align="justify">    
   
**Abstract**   

Lithic artifacts are some of the most common and numerous remains from paleolithic archaeological sites. However, their deposition into the archaeological record can be the result of multiple and distant episodes of discard which can undergo a series of post depositional alterations. Because the numerous amounts of lithic remains, a quick, flexible, and effective method for identifying degrees of alteration in the surface of lithic implements is highly desirable. This would favor the analysis of complete lithic assemblages, inferring their overall integrity, identify different episodes of alteration, and even identify post-depositional alterations of different nature (such as rounding, dragging or wind erosion). This study examines the use gray scale level images to obtain quantitative measures from the surface of flint artifacts and determine if they capture changes due to post-depositional alterations. An experimental collection of flints was subjected to sequential episodes of rounding in a tumbling machine. After each episode, photographs with a Dino-Lite Edge 3.0 AM73915MZT USB microscope were taken, allowing to obtain quantitative values of surface using gray scale level values. The surface quantitative values were employed as variables in machine learning models to determine degree of exposure time and the most important variables for discrimination. Results indicate that the extraction of metrics from gray scale level images successfully capture changes in the surface of flint artifacts caused by post-depositional alterations. Additional results provide insights into which areas to sample in search for post-depositional alterations, and underline the importance of particle size causing the damage.      

**Key words**: lithic taphonomy; experimental archaeology; machine learning    

\ 

## **1. Introduction**   
\ 
Lithic artifacts constitute one of the most common remains from paleolithic archaeological sites. When analyzing lithic assemblages, a key factor to consider is determining the degree of post-depositional alterations undergone by the assemblage, since eco-cultural inferences are drawn from them. Methods for determining assemblage integrity usually focus on the assemblage as a hole. These methods often include spatial analysis of artifacts and analysis of fabrics to determine if water flow has resulted in a reorganization of the spatial distribution and orientations [@lenoble_fabric_2004; @mcpherron_artifact_2005; @mcpherron_additional_2018; @petraglia_water_1994; @schick_experimentally-derived_1987]. Also, lithic size distribution analysis are realized to determine if post-depositional processes have resulted in sorting of the materials [@bertran_particle_2012; @maillo_fernandez_proporciones_1998]. Another option is to focus directly on individual lithic artifacts to determine the degree of alteration that they have undergone [@chu_micro-abrasion_2015; @levi_sala_use_1986]. Although being more time consuming, this type of analysis provides a higher resolution, allowing to establish a graduation in the degree of post-depositional alterations, combine individual data of stone tools with spatial analysis, possible dissection of archaeological episodes, or to detect several episodes of recycling. Individual determination of degree of alteration undergone by a lithic artifact uses microscopic analysis to measure ridge width, visually analyze the surface to determine the existence and intensity of abrasion, and examine the edges to determine the presence of detachments coming from particle impact or dulling of the edges in more extreme cases [@bustos-perez_experimental_2019; @chambers_like_2003; @shackley_stream_1974].   

Post-depositional alterations can affect and interact with stone tools in two broad ways which will be recorded by the tool surface. First, the type of fluvial sedimentary processes which can affect lithic artifacts. Fluvial sedimentary processes are characterized by particle transport and these processes are not homogeneous. Lithic artifacts can form part of these process as another particle, or remain static and be affected by particles being transported. Commonly, three modes of particle transport are described in fluvial sedimentary contexts: rolling, sliding and saltation [@alhusban_assessing_2021], although the last one is not a common form of alteration in the case of stone tools [@petraglia_water_1994]. Additional to alterations coming from fluvial contexts, stone artifacts might also be affected by aeolian particle transport, usually resulting in wind abrasion [@stapert_natural_1976]. The second factor of variability affecting post-depositional alterations of stone tools is the degree of exposure and speed on which a stone tool enters the archaeological record [@petraglia_water_1994; @schick_experimentally-derived_1987; @schiffer_archaeological_1972]. For example, it is expected that partially buried artifacts with water and sediment flowing above them will present modifications in the exposed surface, while the edges and the burred surface will remain semi-intact [@petraglia_water_1994]. A different scenario happens when artifacts are transported by rolling in coarse sediments, resulting in abrasion of all surfaces, dulling of the edges, but at the same time, the impact from coarse particles might result in freshly detached surfaces and edges which undergo new modifications until the artifact enters the archaeological record [@petraglia_water_1994; @sieveking_transport_1987]. Finally, a same homogeneous lithic assemblage might be affected differentially by stream abrasion. This differential alteration is consequence of the complex structure of water streams, were the overall slope of the terrain, energy and charge of the flow, morphology of the channel (which also affects the lateral deposition of sediments) and several other factors result in complex and uneven structures [@rust_structure_1972; @jain_where_2008; @montgomery_channel-reach_1997].    

Thus, obtaining quantitative data of surface modifications can complement values of ridge width, and help identify and interpret type of particle transport undergone by, or affecting a stone artifact. Ideally, quantitative values of surface abrasion would be extracted from each stone artifact, allowing to maximize information and interpretation of the formation process of an archaeological site. However, as previously mentioned, stone artifacts are some of the most common remains from Paleolithic archaeological sites. Thus, a versatile, fast and light time-consuming method is highly desirable since it would enable to analyze large quantities of lithic materials.    

Use-wear studies have shown surface quantification can discriminate worked materials and offer a high resolution analysis of the activities carried out [@stemp_quantification_2009; @ibanez_quantitative_2021; @ibanez_identifying_2019; @ibanez_cereal_2016; @bostrom_quantifying_2022; @pedergnana_polish_2020; @evans_laser_2008]. Previous approaches in the study of use-wear have used grayscale level values for surface analysis of different worked materials [@adan_spatial_2003; @barcelo_image_2001; @bietti_image_1996; @pijoan-lopez_variabilidad_2002; @vila_caracterizacion_1993; @grace_quantification_1985]. Gray scale level analysis offers a series of advantages such as being fast to perform, require low equipment investment and can be applied in the field. This research presents results from a sequential experimentation in which a set of experimentally knapped flakes have undergone rounding process in a tumbler. After each episode of rounding, the same areas are photographed, and quantitative measures of flake surface using grayscale level values are employed to characterize the surface. Following the extraction of quantitative values, machine learning models are employed to determine the degree of separation between rounding times and most important features.    

## **2. Methods**    

### **2.1 Experimental sample and setting**   

Two blocks of flint representing two different types (Type I and Type II) were experimentally knapped. The two types correspond to the South Madrid Miocene Flint [@bustillo_caracterizacion_2012; @bustillo_caracteristicas_2005] although from two different locations. South Madrid Miocene flints were formed by the replacement of sedimentary rocks which had filled the original basin. This replacement of the sedimentary rocks is considered to have taken place under continental conditions such as alluvial plain deposits, shallow lacustrine waters, and marshes [@bustillo_caracterizacion_2012]. Macroscopic analysis of the flints shows that they present a fine opaque homogeneous surface, with colors being blue/grey and reddish/ocher. There is also a relative absence of opal, although geodes and pseudo-morphs can be observed. From these two blocks three flakes were selected from Type 1, and four flakes were selected from Type 2.     

!["Experimental sample of flint flakes (photographs by M. D. Guillén)."](Figures/01-Presenting-materials.png)

In order to simulate sedimentary abrasion, the flakes were introduced by pairs into a tumbler machine (KT-3010 SUPER-TUMBLER) along with a mix of sand and water (30/40% of water with a total weight of 5 kg). Sediment was obtained from the quaternary levels of the Madrid basin and it is composed of fine sands with silt and partial carbonation.    

All flakes were submitted to three cumulative cycles of tumbling with times set to 1h, 5h and 10h. Prior to their introduction into the tumbling machine, 6 photographs (3 per each side) of the surface of each flake were taken in order to have references of texture metrics from flint flakes. Previous research [@chu_micro-abrasion_2015; @bustos-perez_experimental_2019] suggests that, for the development of post depositional alterations, a decrease in particle size increases the heterogeneity in the speed, intensity and location of their development. Thus, after the first cycle of rounding (1h), each flint flake was screened using the Dino-Lite Edge 3.0 AM73915MZT USB microscope in order to determine and photograph areas which had developed sedimentary abrasion. These areas were photographed in the subsequent rounding cycles, allowing to obtain sequential images and data of surface change for cumulative times of 1h, 5h and 10h. The dataset of images was supplemented by the inclusion of sample photographs of macroscopically recognizable geological neocortex of flints from the same formation, providing a total of 269 photographs.    

```{r}
# Load and inspect the data
load("Data/Sequential Data v1.01.RData")
kableExtra::kable(Sequential.Data)
```
```{r, message=FALSE, warning=FALSE}
#load packages
library(tidyverse)
```


```{r}
# Counts of number of images per time of exposure
# (sequential images taken after the first episode of abrasion are not included)
Sequential.Data %>% 
  filter(Photo.Type != "Sequential" | Flake.Time ==  "Fresh" ) %>% 
  group_by(Flake.Time) %>% 
  summarise(
    N.by.Flakes = n()
  )
```


### **2.2 Cleaning protocol, image acquisition and processing**   












### **2.2 Image capturing workflow**   

The present work takes a series of steps prior to realizing any analysis and extracting data form images. These steps are: the cleaning protocol to remove contaminants, image capture, and image enhancement.  
\ 

#### **2.2.1 Cleaning protocol**   

Multiple works emphasize the need of cleaning protocols to remove modern contaminants prior to analysis [@pedergnana_modern_2016; @asryan_results_2020; @olle_use_2014; @fernandez-marchena_microscopic_2016]. Figure \@ref(fig:Figure-01) shows the effect of manual manipulation on the texture of a surface. Because of this, a multi-step procedure based on previous studies was adopted [@pedergnana_modern_2016]. This multi-step procedure included a sonic bath in 2% neutral soap (Derquim) solution during 10 to 15 minutes. This was followed by a second sonic bath in pure acetone during another 10 to 15 minutes. After each step the lithic artefacts were introduced in a water bath and finally dried using pressure air. During the cleaning protocol and microscopic analysis all artefacts were manipulated using surgical gloves.     
\ 


#### **2.2.2 Image capture**

Dino-Lite Edge 3.0 AM73915MZT USB microscope  

-capsule 
vertical stand
-pelota esa  
\ 

#### **2.2.3 Image enhancement**   

A common problem of images obtained from USB microscopes is the lack of detail due to saturation in one of the grey level values and effects of different lightning. This saturation is often observed as a general glaze in one of the grey level values and results in a low quality image with poor detail. To increase detail and quality prior to the analysis, all images were subjected to a two-step process. First, the Fiji pluging *Substract background* was employed to avoid effects of different lightning. Second, the function *enhance contrast* was employed to desaturize the images by normalizing their histograms (Figure \@ref(fig:Figure3)).   
\ 


### **2.3 Image statistical analysis**   

The present work uses three sets of statistical metrics to analyze obtained images. The first set of statistical metrics correspond to  descriptive statistics (mean, standard deviation, mode, median and kurtosis). The second set of statistical measures corresponds to measures of roughness:   

* **Root mean square deviation (Rq)**: indicator of surface roughness.   
* **Arithmetical mean deviation (Ra)**: which indicates the deviation of a surface from a mean height.   
* **Skewness of the assessed profile (Rsk)**: indicator of the departure from surface symmetry. Negative values indicate a surface made of deep valey, and positive values indicates peaks and asperities.   
* **Kurtosis of the assessed profile (Rku)**: which indicates the sharpness of the peaks. Low values indicate blunt peaks, while high values indicate sharp peaks.    

The implementation of these measures is done in ImageJ software [@schneider_nih_2012] through the Roughness calculation plugin [@chinga_roughness_2002].   
\ 

A problem exists when images are analyzed through the intensity distribution of pixels and using descriptive statistics and roughness metrics. Figure \@ref(fig:Figure2) illustrates the problem. Figure \@ref(fig:Figure2) shows a series of pattern images with similar values of intensity, but with different spatial distribution. Regarding descriptive statistics, all images present similar values of mean (127), standard deviation (125), sk (0.01) and kurtosis (-1.99). Regarding measures of roughness, all images present similar values of Rq (180), Ra (127), Rsk (1.42), and Rku (2).    

\ 

Analysis of intensity values through the Gray Level Co-occurrence Matrix (GLCM; @haralick_textural_1973) takes into consideration the spatial distribution of intensity values. The GLCM works in two steps [@haralick_textural_1973]. First, using a given distance and direction (\@ref(fig:Scheme-GLCM)), it builds a matrix which captures the relationship of intensity between pairs of pixels (reference and neighbor). Second, for every *x* and *y* it considers the co-occurrence of values, forming a new matrix. From this new matrix, a series of statistical descriptors are derived [@haralick_textural_1973].  

  * **Angular Second Moment (ASM)** is measure of homogeneity in the image. Homogeneous images (with low gray-tone transitions) will have fewer entries of large magnitude. Thus homogeneous images will have high ASM values, while the opposite will be true for non-homogeneous images.  
  * **Contrast (CONT)** is a value of the amount of local variations, with high values indicating a lot of local variation and low values few local variation.   
  * **Correlation (CORR)** which measures gray-tone linear-dependencies in the image. It indicates how a reference pixel is related to its neighbor. A 0 value indicates it is uncorrelated, and 1 indicates a perfect correlation.   
  * **Inverse Different Moment (IDM)** also referred as **homogeneity**. It obtains the measures of the closeness of the distribution of the GLCM elements to the GLCM diagonal.   
  * **Entropy (ENT)**: is a measure of the amount of irremediable chaos or disorder in an image. High values of entropy indicate values of similar magnitude, while low values indicate unequal entries.   


\ 

The present work implements @haralick_textural_1973 analysis and metrics in ImageJ software [@schneider_nih_2012]. Calculation of GLCM and second order statistics is done through @cabrera_texture_2006 plugin.   

### **2.4 Proof of Concept of GLCM and texture analysis**   

Prior to the application of @haralick_textural_1973 texture metrics a proof of concept from a pilot study is undertaken. This proof of concept is aimed to two objectives. First, determine if the GLCM provides suitable variable values to discriminate between degrees of sedimentary abrasion. Second, to determine to  the best interval of pixels under which the GLCM works

The proof of concept sample is composed of 23 images corresponding to geological neocortex, 56 images corresponding to flakes undergone 10 hours of sedimentary abrasion in a previous experimental study [@bustos-perez_experimental_2019] and 42 images corresponding to fresh surfaces from experimentally knapped flakes. All flints correspond to South Madrid Miocen Flint (@bustillo_caracteristicas_2005; @bustillo_caracterizacion_2012).   

The GLCM requires to test for several distances between the reference pixel and the neighboring pixel on which the spatial relationships are established. The present work tests for five different sequences of distances (Table \@ref(tab:distances)). The first sequence composes the GLCM based on pixels located at distances 1, 2 3 and 4 from the reference pixel. Sequence 2 composes the GLCM based on pixels located at distances 2, 4, 6 and 8 from the reference pixel (Table \@ref(tab:distances). All sequences of intervals are tested in the four cardinal directions (north, east, south and west). This results in 16 (four per each cardinal direction) values of @haralick_textural_1973 textural metrics. Final values are obtained by averaging the different values of each of the variables although range is not considered [@bietti_image_1996].   

## References

</div>   